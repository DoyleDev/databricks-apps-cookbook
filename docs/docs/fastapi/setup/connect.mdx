---
sidebar_position: 3
---

# Connect to a FastAPI App

This recipe demonstrates how to connect to a FastAPI application running on a Databricks Apps runtime using different methods.  
The reader should note that a valid [OAuth2 bearer token](https://docs.databricks.com/aws/en/dev-tools/auth/#databricks-authorization-methods) must be used when calling the Databricks App through the `/api` endpoint.

## Code snippets

The examples for `cURL` and `Python` below show User to Machine (U2M) authentication connectivity where a bearer token is associated with a user identity.

#### cURL

```bash
curl -X GET "https://your-app-url/api/v1/healthcheck" \
  -H "Authorization: Bearer YOUR_DATABRICKS_TOKEN"
```

#### Python

```python
import requests

response = requests.get(
    "https://your-app-url/api/v1/healthcheck",
    headers={"Authorization": f"Bearer YOUR_DATABRICKS_TOKEN"}
)
print(response.json())
```

#### Python - Machine to Machine (M2M) authentication
The example below assumes `DATABRICKS_CLIENT_ID` and `DATABRICKS_CLIENT_SECRET` environment variables are present in order to generate a valid OAuth2 bearer token. In the context of a Databricks App runtime, these variables are present and associated with the attached service principal.

```python
from databricks.sdk import WorkspaceClient
import requests

wc = WorkspaceClient()
headers = wc.config.authenticate()

response = requests.get(
    "https://your-app-url/api/v1/healthcheck", headers=headers
)
print(response.json())
```

## Permissions

For User to Machine (U2M) authentication, your user(s)/group(s) needs the following permissions:

- `CAN USE` on the target app

For Machine to Machine (M2M) authentication, your [app service principal](https://docs.databricks.com/aws/en/dev-tools/databricks-apps/#how-does-databricks-apps-manage-authorization) needs the following permissions:

- `CAN USE` on the target app

## Dependencies

- [Databricks SDK for Python](https://pypi.org/project/databricks-sdk/) - `databricks-sdk`
- [FastAPI](https://pypi.org/project/fastapi/) - `fastapi`
- [Requests](https://pypi.org/project/requests/) - `requests`
- [uvicorn](https://pypi.org/project/uvicorn/) - `uvicorn`


```python title="requirements.txt"
databricks-sdk
fastapi
requests
uvicorn
``` 